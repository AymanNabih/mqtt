import org.eclipse.paho.client.mqttv3.MqttClient;
import org.eclipse.paho.client.mqttv3.MqttConnectOptions;
import org.eclipse.paho.client.mqttv3.MqttException;
import org.eclipse.paho.client.mqttv3.MqttMessage;
import org.eclipse.paho.client.mqttv3.persist.MemoryPersistence;

public class PahoMqttClient {

    static    String broker       = "tcp://localhost:1883";
    static    String clientId     = "Paho Client";
    static    String user         = "user2";
    static    String password     = "pw2";
    static    String topic        = "test";
    static    String content      = "hello world (from paho client)";
	static    boolean retained    = true;
		
    public static void main(String[] args) {
        try {
            MemoryPersistence  persistence = new MemoryPersistence();
            MqttClient         client      = new MqttClient(broker, clientId, persistence);
            MqttConnectOptions opts        = new MqttConnectOptions();
            MqttMessage        message     = new MqttMessage(content.getBytes());
			
            opts.setUserName(user);
            opts.setPassword(password.toCharArray());
			message.setRetained(retained);
			
            client.connect(opts);             System.out.println("Connected to broker");			
            client.publish(topic, message);   System.out.println("Message '"+content+"' published to topic '"+topic+"'");
            client.disconnect();              System.out.println("Disconnected");
			
            System.exit(0);
        } 
		catch(MqttException me) {
            me.printStackTrace();
        }
    }
}